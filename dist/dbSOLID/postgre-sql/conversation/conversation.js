"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = buildConversationDataAccess;

function buildConversationDataAccess({
  connectDb,
  model
}) {
  async function findOne({
    userTwoId = ""
  } = {}) {
    const db = await connectDb();
    const query = {
      where: {
        userTwoId: Number(userTwoId)
      },
      attributes: ["id", "userOneId", "userTwoId"]
    };
    const result = await db.collection("conversation").findOne(query);
    const {
      id
    } = result;
    return {
      id
    };
  }

  async function findAll() {
    const db = await connectDb();
    const query = {
      attributes: ["id", "userOneId", "userTwoId"]
    };
    const result = await db.collection("conversation").findAll(query);
    return result;
  }

  async function create(data) {
    const db = await connectDb();
    const result = await db.collection("conversation").create(data);
    return result;
  }

  return Object.freeze({
    findOne,
    findAll,
    create
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9kYlNPTElEL3Bvc3RncmUtc3FsL2NvbnZlcnNhdGlvbi9jb252ZXJzYXRpb24uanMiXSwibmFtZXMiOlsiYnVpbGRDb252ZXJzYXRpb25EYXRhQWNjZXNzIiwiY29ubmVjdERiIiwibW9kZWwiLCJmaW5kT25lIiwidXNlclR3b0lkIiwiZGIiLCJxdWVyeSIsIndoZXJlIiwiTnVtYmVyIiwiYXR0cmlidXRlcyIsInJlc3VsdCIsImNvbGxlY3Rpb24iLCJpZCIsImZpbmRBbGwiLCJjcmVhdGUiLCJkYXRhIiwiT2JqZWN0IiwiZnJlZXplIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWUsU0FBU0EsMkJBQVQsQ0FBcUM7QUFBRUMsRUFBQUEsU0FBRjtBQUFhQyxFQUFBQTtBQUFiLENBQXJDLEVBQTJEO0FBQ3hFLGlCQUFlQyxPQUFmLENBQXVCO0FBQUVDLElBQUFBLFNBQVMsR0FBRztBQUFkLE1BQXFCLEVBQTVDLEVBQWdEO0FBQzlDLFVBQU1DLEVBQUUsR0FBRyxNQUFNSixTQUFTLEVBQTFCO0FBRUEsVUFBTUssS0FBSyxHQUFHO0FBQ1pDLE1BQUFBLEtBQUssRUFBRTtBQUNMSCxRQUFBQSxTQUFTLEVBQUVJLE1BQU0sQ0FBQ0osU0FBRDtBQURaLE9BREs7QUFJWkssTUFBQUEsVUFBVSxFQUFFLENBQUMsSUFBRCxFQUFPLFdBQVAsRUFBb0IsV0FBcEI7QUFKQSxLQUFkO0FBT0EsVUFBTUMsTUFBTSxHQUFHLE1BQU1MLEVBQUUsQ0FBQ00sVUFBSCxDQUFjLGNBQWQsRUFBOEJSLE9BQTlCLENBQXNDRyxLQUF0QyxDQUFyQjtBQUNBLFVBQU07QUFBRU0sTUFBQUE7QUFBRixRQUFTRixNQUFmO0FBQ0EsV0FBTztBQUFFRSxNQUFBQTtBQUFGLEtBQVA7QUFDRDs7QUFFRCxpQkFBZUMsT0FBZixHQUF5QjtBQUN2QixVQUFNUixFQUFFLEdBQUcsTUFBTUosU0FBUyxFQUExQjtBQUVBLFVBQU1LLEtBQUssR0FBRztBQUNaRyxNQUFBQSxVQUFVLEVBQUUsQ0FBQyxJQUFELEVBQU8sV0FBUCxFQUFvQixXQUFwQjtBQURBLEtBQWQ7QUFJQSxVQUFNQyxNQUFNLEdBQUcsTUFBTUwsRUFBRSxDQUFDTSxVQUFILENBQWMsY0FBZCxFQUE4QkUsT0FBOUIsQ0FBc0NQLEtBQXRDLENBQXJCO0FBQ0EsV0FBT0ksTUFBUDtBQUNEOztBQUVELGlCQUFlSSxNQUFmLENBQXNCQyxJQUF0QixFQUE0QjtBQUMxQixVQUFNVixFQUFFLEdBQUcsTUFBTUosU0FBUyxFQUExQjtBQUVBLFVBQU1TLE1BQU0sR0FBRyxNQUFNTCxFQUFFLENBQUNNLFVBQUgsQ0FBYyxjQUFkLEVBQThCRyxNQUE5QixDQUFxQ0MsSUFBckMsQ0FBckI7QUFDQSxXQUFPTCxNQUFQO0FBQ0Q7O0FBRUQsU0FBT00sTUFBTSxDQUFDQyxNQUFQLENBQWM7QUFDbkJkLElBQUFBLE9BRG1CO0FBRW5CVSxJQUFBQSxPQUZtQjtBQUduQkMsSUFBQUE7QUFIbUIsR0FBZCxDQUFQO0FBS0QiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBidWlsZENvbnZlcnNhdGlvbkRhdGFBY2Nlc3MoeyBjb25uZWN0RGIsIG1vZGVsIH0pIHtcbiAgYXN5bmMgZnVuY3Rpb24gZmluZE9uZSh7IHVzZXJUd29JZCA9IFwiXCIgfSA9IHt9KSB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBjb25uZWN0RGIoKTtcblxuICAgIGNvbnN0IHF1ZXJ5ID0ge1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgdXNlclR3b0lkOiBOdW1iZXIodXNlclR3b0lkKVxuICAgICAgfSxcbiAgICAgIGF0dHJpYnV0ZXM6IFtcImlkXCIsIFwidXNlck9uZUlkXCIsIFwidXNlclR3b0lkXCJdXG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJjb252ZXJzYXRpb25cIikuZmluZE9uZShxdWVyeSk7XG4gICAgY29uc3QgeyBpZCB9ID0gcmVzdWx0O1xuICAgIHJldHVybiB7IGlkIH07XG4gIH1cblxuICBhc3luYyBmdW5jdGlvbiBmaW5kQWxsKCkge1xuICAgIGNvbnN0IGRiID0gYXdhaXQgY29ubmVjdERiKCk7XG5cbiAgICBjb25zdCBxdWVyeSA9IHtcbiAgICAgIGF0dHJpYnV0ZXM6IFtcImlkXCIsIFwidXNlck9uZUlkXCIsIFwidXNlclR3b0lkXCJdXG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJjb252ZXJzYXRpb25cIikuZmluZEFsbChxdWVyeSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZShkYXRhKSB7XG4gICAgY29uc3QgZGIgPSBhd2FpdCBjb25uZWN0RGIoKTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJjb252ZXJzYXRpb25cIikuY3JlYXRlKGRhdGEpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh7XG4gICAgZmluZE9uZSxcbiAgICBmaW5kQWxsLFxuICAgIGNyZWF0ZVxuICB9KTtcbn1cbiJdfQ==